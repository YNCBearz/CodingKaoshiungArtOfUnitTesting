# 單元測試的藝術

## 1-4 什麼是優秀的單元測試

單元測試定義：

一個自動化的程式，可以確保目標程式碼正常運作，執行效率很高，易於理解與維護。

低成本，高效率的程式碼確保機制。

邏輯中常會包含屬性的存取，但作為基本的屬性存取，沒必要對其進行測試，除非其中包含了額外邏輯。

*作者以前只針對流程程式碼進行測試？*
ㄊ

## 1-5 一個簡單的單元測試範例

早期人類訓服測試的畫面。

手動作一個單元測試：看範例。

在撰寫的量越來越多，將測試中常用的方法進行抽離，便於重複利用，可以增加撰寫的效率，測試框架因此誕生。

##### 補充：

測試的3A
* Arrange: 初始化的過程
* Act: 執行測試的目標，並取得實際結果
* Assert: 驗證結果
[https://ithelp.ithome.com.tw/articles/10185338/](https://ithelp.ithome.com.tw/articles/10185338/)


## 1-6 測試驅動開發

何時撰寫測試？

簡單講講測試驅動開發：

定義：先測試，再寫功能。

#### 傳統：

1. 撰寫功能
2. 寫測試(有時間的話)
3. 執行測試(有時間的話)
4. 程式碼除錯

#### 測試驅動：

1. 撰寫測試
2. 執行測試(確定失敗)
3. 寫產品程式碼
4. 執行測試
    1. 失敗 > 改寫程式碼 > 執行4.
    2. 成功 > 重構程式碼 > 執行4.
    3. 完成所有功能並重構完成 > 下一個測試 > 執行1.

###### 本書並非要講TDD，而是單元測試的藝術(測試的命名、維護性、可讀性)。

#### 關於撰寫測試：

1. 撰寫測試
2. 撰寫**僅僅**可以通過編譯的程式碼
3. 進行肯定失敗的測試
4. 撰寫盡量簡單的程式碼通過測試

#### 關於重構：

時機：可以每次通過測試就重構、或者完成一批程式重構。

作法：修改名稱、去除重複程式碼...

目的：增加程式碼的易維護、易讀、易改、易偵錯。

測試如何增加信任：
當該成功時成功、該失敗時失敗，才是一個可信任的測試。

而TDD的流程可以幫助寫出可信任的測試。

## 1-7 成功進行TDD的三種技能

1.  撰寫好的測試：測試具有可維護、易讀、且可靠。
2.  執行正確的TDD：作者推薦《Test-Driven Development: By Example (Paperback)》[https://www.tenlong.com.tw/products/9780321146533](https://www.tenlong.com.tw/products/9780321146533)
3. 撰寫高品質的程式碼：作者推薦
    - 《Test-Driven Development: By Example (Paperback)》[http://www.growing-object-oriented-software.com/](http://www.growing-object-oriented-software.com/)
    - 《Growing Object-Oriented Software Guided by Tests》[http://www.growing-object-oriented-software.com/](http://www.growing-object-oriented-software.com/)

## 1-8 小結

1. 優秀單元測試的特色
    1. 定義：**使用框架**對一段特定的邏輯進行**自動化**測試
    2. 高效率：可以快速、多次進行測試、便於維護
    3. 可靠信：可以確保邏輯正確，團隊每個人的執行結果都相同
2. 整合測試 vs 單元測試：正確區分使用時機可以增加效率。
3. 使用測試框架，讓測試的撰寫與維護更加方便。
4. 正確的單元測試與TDD的實踐相輔相成，就可早點下班。
